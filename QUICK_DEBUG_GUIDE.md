# å¿«é€Ÿè°ƒè¯•æŒ‡å— âš¡

> æ— éœ€è¿æ¥ Google Sheetsï¼Œä½¿ç”¨æœ¬åœ° Excel æ–‡ä»¶å¿«é€Ÿè°ƒè¯•

## ğŸ¯ ç›®æ ‡

ä»æœ¬åœ° Excel æ–‡ä»¶ï¼š
1. âœ… æå–æ‰€æœ‰äººåï¼Œç”Ÿæˆåˆ«å CSV
2. âœ… æœ¬åœ°æµ‹è¯•æ¸…æ´—é€»è¾‘
3. âœ… è°ƒè¯•é…ç½®å’Œè§„åˆ™
4. âœ… å‡†å¤‡ä¸Šä¼ åˆ° Google Sheets

## ğŸ“¦ å½“å‰çŠ¶æ€

âœ… å·²ä» Excel æå– **127 ä¸ªå”¯ä¸€äººå**  
âœ… å·²ç”Ÿæˆåˆ«å CSVï¼š`tests/generated_aliases.csv`  
ğŸ“‹ å¾…åŠï¼šç¼–è¾‘åˆ«åè¡¨ï¼Œåˆå¹¶åŒä¸€äººçš„ä¸åŒå†™æ³•

## ğŸš€ ä¸‰æ­¥å¿«é€Ÿå¼€å§‹

### æ­¥éª¤ 1ï¼šç¼–è¾‘åˆ«åè¡¨ï¼ˆ**å½“å‰æ­¥éª¤**ï¼‰

æ‰“å¼€ `tests/generated_aliases.csv`ï¼Œåˆå¹¶åŒä¸€äººçš„ä¸åŒå†™æ³•ï¼š

**ç¤ºä¾‹**ï¼š

åŸå§‹æ•°æ®ï¼š
```csv
Zoey,person_zoey,Zoey,33,
Zoey Zhou,person_zoeyzhou,Zoey Zhou,16,
```

ä¿®æ”¹ä¸ºï¼š
```csv
Zoey,person_zoey_zhou,Zoey Zhou,33,
Zoey Zhou,person_zoey_zhou,Zoey Zhou,16,
```

**å‡ºç°é¢‘ç‡æœ€é«˜çš„å‰ 20 ä½**ï¼ˆä¼˜å…ˆå¤„ç†ï¼‰ï¼š

```
 1. ç‹é€š    - 124 æ¬¡
 2. å¿ æ¶µ    -  61 æ¬¡
 3. é–é“®    -  57 æ¬¡
 4. ä¿Šé‘«    -  47 æ¬¡
 5. Jimmy  -  44 æ¬¡
 6. å¼ å®‡    -  36 æ¬¡
 7. Zoey   -  33 æ¬¡
 8. Gavin  -  33 æ¬¡
 9. Daniel -  26 æ¬¡
10. èµµè¶…    -  22 æ¬¡
11. å±ˆå°ç…Š   -  22 æ¬¡
12. Enqi   -  18 æ¬¡
13. åäºšè¥¿   -  18 æ¬¡
14. Zoey Zhou - 16 æ¬¡
15. å­™å½¤    -  14 æ¬¡
16. æœ±å®¶éœ–   -  14 æ¬¡
17. äºšè¥¿    -  13 æ¬¡  â† å¯èƒ½å’Œ"åäºšè¥¿"æ˜¯åŒä¸€äºº
18. Weiwei -  13 æ¬¡
19. ä½•å‡¯    -  12 æ¬¡
20. å‘¨æ´ªäº®   -  11 æ¬¡
```

**éœ€è¦æ£€æŸ¥åˆå¹¶çš„**ï¼š
- `åäºšè¥¿` (18æ¬¡) + `äºšè¥¿` (13æ¬¡) â†’ å¯èƒ½æ˜¯åŒä¸€äºº
- `Zoey` (33æ¬¡) + `Zoey Zhou` (16æ¬¡) â†’ å¯èƒ½æ˜¯åŒä¸€äºº
- `Jason` (10æ¬¡) + `Jason Yang` (11æ¬¡) â†’ å¯èƒ½æ˜¯åŒä¸€äºº

### æ­¥éª¤ 2ï¼šæœ¬åœ°æµ‹è¯•æ¸…æ´—

```bash
python3 scripts/debug_clean_local.py \
    --excel "tests/Grace Irvine Sunday Worship All in One (1).xlsx" \
    --aliases tests/generated_aliases.csv \
    -o tests/debug_output.csv
```

**è¾“å‡º**ï¼š
- `tests/debug_output.csv` - æ¸…æ´—åçš„æ•°æ®
- `tests/debug_output.json` - JSON æ ¼å¼
- æ§åˆ¶å°æ˜¾ç¤ºæ ¡éªŒæŠ¥å‘Š

### æ­¥éª¤ 3ï¼šæŸ¥çœ‹ç»“æœ

```bash
# ç”¨ Excel æˆ– Numbers æ‰“å¼€æŸ¥çœ‹
open tests/debug_output.csv

# æˆ–ç”¨å‘½ä»¤è¡ŒæŸ¥çœ‹å‰å‡ è¡Œ
head -20 tests/debug_output.csv
```

æ£€æŸ¥ï¼š
- âœ… æ—¥æœŸæ ¼å¼æ˜¯å¦æ­£ç¡®ï¼ˆYYYY-MM-DDï¼‰
- âœ… äººå‘˜ ID æ˜¯å¦æ˜ å°„æ­£ç¡®
- âœ… æ˜¾ç¤ºåç§°æ˜¯å¦ç»Ÿä¸€
- âœ… æ­Œæ›²æ˜¯å¦æ­£ç¡®æ‹†åˆ†

## ğŸ”„ è¿­ä»£æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ç¼–è¾‘åˆ«åè¡¨   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. è¿è¡Œæµ‹è¯•æ¸…æ´— â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. æ£€æŸ¥ç»“æœ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
  â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
  â”‚ æ»¡æ„å—ï¼Ÿ    â”‚
  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
        â”‚
   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
   â”‚ å¦      â”‚ æ˜¯
   â”‚         â”‚
   â–¼         â–¼
å›æ­¥éª¤1    å®Œæˆï¼âœ…
```

## ğŸ“ å¸¸ç”¨å‘½ä»¤

### é‡æ–°æå–äººåï¼ˆå¦‚æœéœ€è¦ï¼‰

```bash
python3 scripts/extract_aliases_smart.py \
    --excel "tests/Grace Irvine Sunday Worship All in One (1).xlsx" \
    -o tests/generated_aliases.csv
```

### ç”Ÿæˆç”¨äºä¸Šä¼  Google Sheets çš„ç‰ˆæœ¬

```bash
python3 scripts/extract_aliases_smart.py \
    --excel "tests/Grace Irvine Sunday Worship All in One (1).xlsx" \
    -o tests/aliases_for_sheets.csv \
    --no-count
```

ï¼ˆç„¶åæ‰‹åŠ¨ç¼–è¾‘ï¼Œåˆå¹¶åˆ«åï¼‰

### æŸ¥çœ‹å¸®åŠ©

```bash
python3 scripts/extract_aliases_smart.py --help
python3 scripts/debug_clean_local.py --help
```

## ğŸ’¡ ç¼–è¾‘æŠ€å·§

### 1. ä½¿ç”¨ Excel çš„ç­›é€‰åŠŸèƒ½

1. æ‰“å¼€ `tests/generated_aliases.csv`
2. é€‰æ‹©è¡¨å¤´è¡Œ
3. æ•°æ® â†’ ç­›é€‰
4. æŒ‰ `count` é™åºæ’åºï¼Œä¼˜å…ˆå¤„ç†é«˜é¢‘äººå

### 2. ä½¿ç”¨æŸ¥æ‰¾æ›¿æ¢æ‰¹é‡ä¿®æ”¹

åˆå¹¶åŒä¸€äººæ—¶ï¼Œæ‰¹é‡æ›¿æ¢ `person_id`ï¼š

1. Ctrl+Hï¼ˆWindowsï¼‰æˆ– Cmd+Hï¼ˆMacï¼‰
2. æŸ¥æ‰¾ï¼š`person_zoey`
3. æ›¿æ¢ä¸ºï¼š`person_zoey_zhou`
4. å…¨éƒ¨æ›¿æ¢

### 3. æ·»åŠ å¤‡æ³¨

åœ¨ `note` åˆ—æ ‡è®°è§’è‰²ï¼š

```csv
alias,person_id,display_name,count,note
ç‹é€š,person_wangtong,ç‹é€š,124,ç‰§å¸ˆ
```

## â“ å¸¸è§é—®é¢˜

### Q: å¦‚ä½•çŸ¥é“å“ªäº›æ˜¯åŒä¸€äººçš„ä¸åŒå†™æ³•ï¼Ÿ

A: æŸ¥çœ‹æç¤ºï¼š
1. **ç›¸ä¼¼çš„åå­—**ï¼š`åäºšè¥¿` vs `äºšè¥¿`
2. **å…¨å vs ç®€ç§°**ï¼š`Zoey Zhou` vs `Zoey`
3. **è‹±æ–‡ vs ä¸­æ–‡**ï¼šéœ€è¦äººå·¥åˆ¤æ–­

### Q: person_id çš„å‘½åè§„åˆ™æ˜¯ä»€ä¹ˆï¼Ÿ

A: å»ºè®®ï¼š
- è‹±æ–‡ï¼š`person_firstname_lastname`ï¼ˆå¦‚ `person_zoey_zhou`ï¼‰
- ä¸­æ–‡ï¼š`person_æ‹¼éŸ³`ï¼ˆå¦‚ `person_wangtong`ï¼‰
- ä¿æŒç®€æ´ã€æ˜“è¯»

### Q: å¦‚æœä¸ç¡®å®šæ˜¯å¦åŒä¸€äººæ€ä¹ˆåŠï¼Ÿ

A: 
- **ä¿å®ˆç­–ç•¥**ï¼šå…ˆä¸åˆå¹¶ï¼Œä¿æŒç‹¬ç«‹
- åç»­å¯ä»¥æ ¹æ®å®é™…æƒ…å†µå†è°ƒæ•´

## ğŸ‰ å®Œæˆå

å½“æœ¬åœ°è°ƒè¯•æ»¡æ„åï¼š

1. **æ›´æ–° README**ï¼šè®°å½•æœ€ç»ˆçš„åˆ«åæ•°é‡
2. **ä¸Šä¼ åˆ° Google Sheets**ï¼š
   - ç”Ÿæˆæ— ç»Ÿè®¡åˆ—ç‰ˆæœ¬ï¼š`--no-count`
   - ä¸Šä¼ åˆ° Google Sheets
   - æ›´æ–° `config/config.json`
3. **è¿è¡Œæ­£å¼ç®¡çº¿**ï¼š
   ```bash
   ./run_pipeline.sh --dry-run
   ```

## ğŸ“š è¯¦ç»†æ–‡æ¡£

æ›´å¤šè¯¦ç»†è¯´æ˜ï¼Œè¯·å‚è€ƒï¼š
- [DEBUG_WORKFLOW.md](DEBUG_WORKFLOW.md) - å®Œæ•´å·¥ä½œæµç¨‹
- [README.md](README.md) - ç”¨æˆ·æŒ‡å—
- [PROJECT_OVERVIEW.md](PROJECT_OVERVIEW.md) - æ¶æ„è¯´æ˜

---

**ä¸‹ä¸€æ­¥**ï¼šç¼–è¾‘ `tests/generated_aliases.csv`ï¼Œåˆå¹¶åŒä¸€äººçš„ä¸åŒå†™æ³•

