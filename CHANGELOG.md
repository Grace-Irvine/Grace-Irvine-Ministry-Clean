# æ›´æ–°æ—¥å¿—

æœ¬é¡¹ç›®çš„æ‰€æœ‰é‡è¦å˜æ›´éƒ½å°†è®°å½•åœ¨æ­¤æ–‡ä»¶ä¸­ã€‚

æ ¼å¼åŸºäº [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)ï¼Œ
ç‰ˆæœ¬å·éµå¾ª [è¯­ä¹‰åŒ–ç‰ˆæœ¬](https://semver.org/lang/zh-CN/)ã€‚

## [2.0.0] - 2025-10-07

### æ–°å¢ âœ¨

#### æœåŠ¡å±‚ï¼ˆService Layerï¼‰
- ğŸ“¦ **æœåŠ¡å±‚æ¶æ„**ï¼šå°†æ¸…æ´—å±‚æ•°æ®è½¬æ¢ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„é¢†åŸŸæ¨¡å‹
  - Sermon Domainï¼ˆè¯é“åŸŸï¼‰ï¼šè¯é“ç›¸å…³çš„æ ¸å¿ƒä¿¡æ¯
  - Volunteer Domainï¼ˆåŒå·¥åŸŸï¼‰ï¼šä¸»æ—¥æœä¾åŒå·¥ä¿¡æ¯
- ğŸ”„ **è‡ªåŠ¨ç”Ÿæˆæ‰€æœ‰å¹´ä»½**ï¼šæ™ºèƒ½æ£€æµ‹å¹¶ç”Ÿæˆæ‰€æœ‰å†å²å¹´ä»½çš„æ•°æ®
- â˜ï¸ **Cloud Storage é›†æˆ**ï¼šè‡ªåŠ¨ä¸Šä¼ åˆ° Google Cloud Storage
- ğŸ“Š **æ•°æ®ç»„ç»‡**ï¼šæŒ‰é¢†åŸŸå’Œå¹´ä»½ç»„ç»‡æ–‡ä»¶ï¼ˆlatest + yearlyï¼‰

#### äº‘éƒ¨ç½²ï¼ˆCloud Deploymentï¼‰
- â˜ï¸ **Cloud Run éƒ¨ç½²**ï¼šä¸€é”®éƒ¨ç½²åˆ° Google Cloud Run
- â° **Cloud Scheduler**ï¼šå®šæ—¶ä»»åŠ¡è‡ªåŠ¨æ›´æ–°æ•°æ®ï¼ˆæ¯30åˆ†é’Ÿï¼‰
- ğŸ” **æ™ºèƒ½å˜åŒ–æ£€æµ‹**ï¼šSHA-256å“ˆå¸Œæ¯”å¯¹ï¼Œä»…åœ¨æ•°æ®å˜åŒ–æ—¶æ‰§è¡Œæ¸…æ´—
- ğŸš€ **FastAPI åº”ç”¨**ï¼šæä¾›å®Œæ•´çš„ RESTful API
- ğŸ”’ **Bearer Token è®¤è¯**ï¼šä¿æŠ¤å®šæ—¶è§¦å‘ç«¯ç‚¹

#### API ç«¯ç‚¹
- `POST /api/v1/clean` - æ‰‹åŠ¨è§¦å‘æ•°æ®æ¸…æ´—
- `POST /api/v1/query` - æŸ¥è¯¢æ•°æ®ï¼ˆæ”¯æŒå¤šç§è¿‡æ»¤æ¡ä»¶ï¼‰
- `GET /api/v1/stats` - è·å–ç»Ÿè®¡ä¿¡æ¯
- `GET /api/v1/preview` - è·å–æœ€æ–°æ¸…æ´—é¢„è§ˆ
- `POST /api/v1/service-layer/generate` - ç”ŸæˆæœåŠ¡å±‚æ•°æ®
- `GET /api/v1/sermon` - è·å–è¯é“åŸŸæ•°æ®
- `GET /api/v1/volunteer` - è·å–åŒå·¥åŸŸæ•°æ®
- `POST /trigger-cleaning` - Cloud Scheduler è§¦å‘ç«¯ç‚¹
- `GET /mcp/tools` - MCP å·¥å…·å®šä¹‰

#### å­˜å‚¨å’Œæ•°æ®ç®¡ç†
- ğŸ“¦ **Google Cloud Storage Bucket**ï¼šgrace-irvine-ministry-data
- ğŸ“ **æ–‡ä»¶ç»„ç»‡ç»“æ„**ï¼šdomains/sermon|volunteer/{latest, 2024, 2025, 2026}
- ğŸ”„ **ç‰ˆæœ¬æ§åˆ¶**ï¼šæ”¯æŒå†å²ç‰ˆæœ¬ç®¡ç†

#### å·¥å…·å’Œè„šæœ¬
- `scripts/service_layer.py` - æœåŠ¡å±‚è½¬æ¢å™¨
- `scripts/cloud_storage_utils.py` - äº‘å­˜å‚¨å·¥å…·
- `scripts/change_detector.py` - å˜åŒ–æ£€æµ‹
- `app.py` - FastAPI åº”ç”¨
- `Dockerfile` - å®¹å™¨é…ç½®
- `deploy-cloud-run.sh` - éƒ¨ç½²è„šæœ¬
- `setup-cloud-scheduler.sh` - å®šæ—¶ä»»åŠ¡è®¾ç½®

#### æµ‹è¯•è„šæœ¬
- `test_deployed_api.sh` - API ç«¯ç‚¹æµ‹è¯•
- `test_change_detection.sh` - å˜åŒ–æ£€æµ‹æµ‹è¯•
- `test_service_layer.sh` - æœåŠ¡å±‚æµ‹è¯•
- `test_all_years_api.sh` - æ‰€æœ‰å¹´ä»½APIæµ‹è¯•

#### æ–‡æ¡£
- `SERVICE_LAYER.md` - æœåŠ¡å±‚å®Œæ•´æ–‡æ¡£
- `DEPLOYMENT.md` - äº‘éƒ¨ç½²å®Œæ•´æ–‡æ¡£
- `STORAGE.md` - å­˜å‚¨å’Œæ•°æ®ç®¡ç†æ–‡æ¡£
- `MCP_INTEGRATION.md` - MCP é›†æˆæŒ‡å—
- `TROUBLESHOOTING.md` - æ•…éšœæ’é™¤æŒ‡å—
- `QUICK_COMMANDS.md` - å¿«é€Ÿå‘½ä»¤å‚è€ƒ
- `ARCHITECTURE.md` - é¡¹ç›®æ¶æ„æ–‡æ¡£

### æ”¹è¿› ğŸ”§

#### æ€§èƒ½ä¼˜åŒ–
- âš¡ **æ™ºèƒ½è·³è¿‡**ï¼šæ— æ•°æ®å˜åŒ–æ—¶< 1ç§’è¿”å›
- ğŸ¯ **å¹¶è¡Œå¤„ç†**ï¼šå¤šå¹´ä»½å¹¶è¡Œç”Ÿæˆ
- ğŸ“Š **å¢é‡æ›´æ–°**ï¼šä»…æ›´æ–°å˜åŒ–çš„éƒ¨åˆ†

#### ç”¨æˆ·ä½“éªŒ
- ğŸ“ **è¯¦ç»†æ—¥å¿—**ï¼šå®Œæ•´çš„æ“ä½œè®°å½•å’Œé”™è¯¯ä¿¡æ¯
- ğŸ¨ **äº¤äº’å¼ API æ–‡æ¡£**ï¼šSwagger UIï¼ˆ/docsï¼‰
- ğŸ“Š **å®æ—¶ç»Ÿè®¡**ï¼šåŠ¨æ€æ•°æ®ç»Ÿè®¡å’Œåˆ†æ

### æŠ€æœ¯æ ˆæ›´æ–° ğŸ› ï¸

#### æ–°å¢ä¾èµ–
- `fastapi>=0.109.0` - Web æ¡†æ¶
- `uvicorn[standard]>=0.27.0` - ASGI æœåŠ¡å™¨
- `pydantic>=2.5.0` - æ•°æ®éªŒè¯
- `google-cloud-storage` - GCS é›†æˆï¼ˆå¯é€‰ï¼‰
- `python-multipart>=0.0.6` - æ–‡ä»¶ä¸Šä¼ æ”¯æŒ

#### éƒ¨ç½²å·¥å…·
- Docker - å®¹å™¨åŒ–
- Google Cloud Build - é•œåƒæ„å»º
- Google Cloud Run - æ— æœåŠ¡å™¨éƒ¨ç½²
- Google Cloud Scheduler - å®šæ—¶ä»»åŠ¡
- Google Cloud Storage - å¯¹è±¡å­˜å‚¨

### æ•°æ®æµ ğŸ”„

```
åŸå§‹å±‚ (Google Sheets)
    â†“
æ¸…æ´—å±‚ (Google Sheets)
    â†“
æœåŠ¡å±‚ (JSON)
    â”œâ”€â”€ Sermon Domain
    â””â”€â”€ Volunteer Domain
    â†“
Cloud Storage (GCS)
    â”œâ”€â”€ latest.json
    â””â”€â”€ yearly files (2024, 2025, 2026)
```

### æˆæœ¬ä¼°ç®— ğŸ’°

- **Cloud Run**ï¼š~$0.57/æœˆï¼ˆåŸºæœ¬åœ¨å…è´¹é¢åº¦å†…ï¼‰
- **Cloud Scheduler**ï¼š$0.00/æœˆï¼ˆå…è´¹é¢åº¦å†…ï¼‰
- **Cloud Storage**ï¼š< $0.01/æœˆï¼ˆ490 KBï¼‰
- **æ€»è®¡**ï¼š~$0.57/æœˆ

### å®‰å…¨æ›´æ–° ğŸ”’

- ğŸ” Bearer Token è®¤è¯ä¿æŠ¤å®šæ—¶ä»»åŠ¡
- ğŸ”’ Secret Manager å­˜å‚¨æ•æ„Ÿå‡­è¯
- ğŸ›¡ï¸ æœ€å°æƒé™åŸåˆ™ï¼ˆIAMï¼‰
- ğŸ” è¯¦ç»†çš„å®¡è®¡æ—¥å¿—

---

## [1.0.0] - 2025-10-06

### æ–°å¢ âœ¨

#### æ ¸å¿ƒåŠŸèƒ½
- å®Œæ•´çš„æ•°æ®æ¸…æ´—ç®¡çº¿ï¼Œæ”¯æŒä»åŸå§‹ Google Sheet åˆ°æ¸…æ´—å±‚ Google Sheet çš„è‡ªåŠ¨åŒ–æ¸…æ´—
- å¯é…ç½®çš„æ¸…æ´—è§„åˆ™ï¼ˆé€šè¿‡ `config/config.json` ç®¡ç†ï¼‰
- äººååˆ«åæ˜ å°„åŠŸèƒ½ï¼Œæ”¯æŒå¤šå¯¹ä¸€æ˜ å°„ï¼ˆä¸­æ–‡å/è‹±æ–‡å/æ˜µç§° â†’ ç»Ÿä¸€ IDï¼‰
- æ•°æ®æ ¡éªŒåŠŸèƒ½ï¼Œç”Ÿæˆè¯¦ç»†çš„é”™è¯¯å’Œè­¦å‘ŠæŠ¥å‘Š
- Dry-run æ¨¡å¼ï¼Œæ”¯æŒå…ˆé¢„è§ˆåå†™å…¥

#### æ¸…æ´—è§„åˆ™
- æ—¥æœŸæ ‡å‡†åŒ–ï¼ˆæ”¯æŒå¤šç§æ ¼å¼è¾“å…¥ï¼Œç»Ÿä¸€è¾“å‡º YYYY-MM-DDï¼‰
- æ–‡æœ¬æ¸…ç†ï¼ˆå»é™¤ç©ºæ ¼ã€å…¨è§’ç©ºæ ¼ã€å ä½ç¬¦å¤„ç†ï¼‰
- ç»æ–‡å¼•ç”¨æ ‡å‡†åŒ–
- æ­Œæ›²æ‹†åˆ†ä¸å»é‡ï¼ˆæ”¯æŒå¤šç§åˆ†éš”ç¬¦ï¼‰
- åˆ—åˆå¹¶åŠŸèƒ½ï¼ˆå¦‚åˆå¹¶å¤šä¸ªæ•¬æ‹œåŒå·¥åˆ—ï¼‰
- æœåŠ¡å‘¨æ•°è‡ªåŠ¨è®¡ç®—ï¼ˆISO å‘¨æ•°ï¼‰

#### æ¨¡å—
- `gsheet_utils.py`: Google Sheets API å°è£…
- `cleaning_rules.py`: æ¸…æ´—è§„åˆ™å®ç°
- `alias_utils.py`: åˆ«åæ˜ å°„å·¥å…·
- `validators.py`: æ•°æ®æ ¡éªŒå™¨
- `clean_pipeline.py`: ä¸»æ¸…æ´—ç®¡çº¿

#### å·¥å…·å’Œè„šæœ¬
- `run_pipeline.sh`: ä¾¿æ·æ‰§è¡Œè„šæœ¬ï¼Œæ”¯æŒå‚æ•°è§£æå’Œç¯å¢ƒæ£€æŸ¥
- å®Œæ•´çš„å•å…ƒæµ‹è¯•å¥—ä»¶ï¼ˆ`tests/test_cleaning.py`ï¼‰
- æ ·ä¾‹æ•°æ®ï¼ˆ`tests/sample_raw.csv`, `tests/sample_aliases.csv`ï¼‰

#### æ–‡æ¡£
- å®Œæ•´çš„ç”¨æˆ·æŒ‡å—ï¼ˆ`README.md`ï¼‰
- å¿«é€Ÿä¸Šæ‰‹æŒ‡å—ï¼ˆ`QUICKSTART.md`ï¼‰
- é¡¹ç›®æ¦‚è§ˆæ–‡æ¡£ï¼ˆ`PROJECT_OVERVIEW.md`ï¼‰
- ä»»åŠ¡è¯´æ˜æ–‡æ¡£ï¼ˆ`README_prompt.md`ï¼‰
- ç¤ºä¾‹é…ç½®æ–‡ä»¶ï¼ˆ`config/config.example.json`ï¼‰

#### è¾“å‡º
- CSV é¢„è§ˆæ–‡ä»¶
- JSON é¢„è§ˆæ–‡ä»¶
- è¯¦ç»†çš„æ ¡éªŒæŠ¥å‘Šï¼ˆä¿å­˜åˆ° `logs/`ï¼‰
- æ§åˆ¶å°æ‘˜è¦è¾“å‡º

### å®‰å…¨ ğŸ”’
- æœ€å°æƒé™åŸåˆ™ï¼ˆåŸå§‹è¡¨åªè¯»ã€æ¸…æ´—è¡¨åªå†™ï¼‰
- æœåŠ¡è´¦å·è®¤è¯
- æ•æ„Ÿä¿¡æ¯ä¿æŠ¤ï¼ˆ`.gitignore` é…ç½®ï¼‰
- æ—¥å¿—ä¸æ‰“å°æ•æ„Ÿä»¤ç‰Œ

### æµ‹è¯• ğŸ§ª
- å•å…ƒæµ‹è¯•è¦†ç›–æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ï¼ˆ17ä¸ªæµ‹è¯•ï¼Œ100%é€šè¿‡ï¼‰
- æ—¥æœŸæ¸…æ´—æµ‹è¯•
- åˆ«åæ˜ å°„æµ‹è¯•
- æ­Œæ›²æ‹†åˆ†æµ‹è¯•
- åˆ—åˆå¹¶æµ‹è¯•
- æ•°æ®æ ¡éªŒæµ‹è¯•
- å®Œæ•´ç®¡çº¿æµ‹è¯•

---

## ç‰ˆæœ¬è¯´æ˜

### ç‰ˆæœ¬å·æ ¼å¼ï¼šä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.ä¿®è®¢å·

- **ä¸»ç‰ˆæœ¬å·ï¼ˆMajorï¼‰**ï¼šä¸å…¼å®¹çš„ API å˜æ›´
- **æ¬¡ç‰ˆæœ¬å·ï¼ˆMinorï¼‰**ï¼šå‘ä¸‹å…¼å®¹çš„åŠŸèƒ½æ–°å¢
- **ä¿®è®¢å·ï¼ˆPatchï¼‰**ï¼šå‘ä¸‹å…¼å®¹çš„é—®é¢˜ä¿®å¤

### å˜æ›´ç±»å‹

- **æ–°å¢ï¼ˆAddedï¼‰**ï¼šæ–°åŠŸèƒ½
- **å˜æ›´ï¼ˆChangedï¼‰**ï¼šç°æœ‰åŠŸèƒ½çš„å˜æ›´
- **åºŸå¼ƒï¼ˆDeprecatedï¼‰**ï¼šå³å°†ç§»é™¤çš„åŠŸèƒ½
- **ç§»é™¤ï¼ˆRemovedï¼‰**ï¼šå·²ç§»é™¤çš„åŠŸèƒ½
- **ä¿®å¤ï¼ˆFixedï¼‰**ï¼šé—®é¢˜ä¿®å¤
- **å®‰å…¨ï¼ˆSecurityï¼‰**ï¼šå®‰å…¨ç›¸å…³çš„å˜æ›´
