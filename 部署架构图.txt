========================================
   Cloud Run éƒ¨ç½²æ¶æ„ - å·²éªŒè¯æˆåŠŸ
========================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Google Cloud Platform                        â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              Cloud Run Service                           â”‚   â”‚
â”‚  â”‚  ministry-data-cleaning-wu7uk5rgdq-uc.a.run.app         â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚   â”‚
â”‚  â”‚  â”‚          FastAPI Application                 â”‚        â”‚   â”‚
â”‚  â”‚  â”‚                                              â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  Endpoints:                                  â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ GET  /health                             â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ GET  /docs                               â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ POST /api/v1/clean                       â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ POST /api/v1/service-layer/generate      â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ GET  /api/v1/sermon                      â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ GET  /api/v1/volunteer                   â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ GET  /api/v1/stats                       â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ POST /trigger-cleaning (scheduler)       â”‚        â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   â”‚
â”‚  â”‚                        â”‚                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚                                     â”‚
â”‚                           â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         Service Layer Manager                          â”‚    â”‚
â”‚  â”‚  â€¢ Sermon Domain Transformer                           â”‚    â”‚
â”‚  â”‚  â€¢ Volunteer Domain Transformer                        â”‚    â”‚
â”‚  â”‚  â€¢ Multi-year generation (2024, 2025, 2026, latest)   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                           â”‚                                     â”‚
â”‚                           â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         Cloud Storage Integration                      â”‚    â”‚
â”‚  â”‚  gs://grace-irvine-ministry-data/domains/             â”‚    â”‚
â”‚  â”‚                                                         â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ sermon/                                           â”‚    â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ latest.json                   âœ…             â”‚    â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ 2024/sermon_2024.json         âœ…             â”‚    â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ 2025/sermon_2025.json         âœ…             â”‚    â”‚
â”‚  â”‚  â”‚   â””â”€â”€ 2026/sermon_2026.json         âœ…             â”‚    â”‚
â”‚  â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚  â””â”€â”€ volunteer/                                        â”‚    â”‚
â”‚  â”‚      â”œâ”€â”€ latest.json                   âœ…             â”‚    â”‚
â”‚  â”‚      â”œâ”€â”€ 2024/volunteer_2024.json      âœ…             â”‚    â”‚
â”‚  â”‚      â”œâ”€â”€ 2025/volunteer_2025.json      âœ…             â”‚    â”‚
â”‚  â”‚      â””â”€â”€ 2026/volunteer_2026.json      âœ…             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                           â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   Google Sheets API      â”‚
              â”‚  â€¢ Source Sheet (read)   â”‚
              â”‚  â€¢ Target Sheet (write)  â”‚
              â”‚  â€¢ Alias Sheet (read)    â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

========================================
        æ•°æ®æµ (Data Flow)
========================================

1. æ•°æ®æ¸…æ´—æµç¨‹:
   Google Sheets (åŸå§‹æ•°æ®)
        â”‚
        â–¼
   Cloud Run (æ¸…æ´—ç®¡çº¿)
        â”‚
        â”œâ”€â”€â–º Google Sheets (æ¸…æ´—åæ•°æ®)
        â”‚
        â””â”€â”€â–º logs/clean_preview.json (é¢„è§ˆ)

2. æœåŠ¡å±‚ç”Ÿæˆæµç¨‹:
   clean_preview.json
        â”‚
        â–¼
   Service Layer Manager
        â”‚
        â”œâ”€â”€â–º Sermon Domain Transformer
        â”‚         â”‚
        â”‚         â”œâ”€â”€â–º logs/service_layer/sermon.json (latest)
        â”‚         â”œâ”€â”€â–º logs/service_layer/2024/sermon_2024.json
        â”‚         â”œâ”€â”€â–º logs/service_layer/2025/sermon_2025.json
        â”‚         â””â”€â”€â–º logs/service_layer/2026/sermon_2026.json
        â”‚
        â””â”€â”€â–º Volunteer Domain Transformer
                  â”‚
                  â”œâ”€â”€â–º logs/service_layer/volunteer.json (latest)
                  â”œâ”€â”€â–º logs/service_layer/2024/volunteer_2024.json
                  â”œâ”€â”€â–º logs/service_layer/2025/volunteer_2025.json
                  â””â”€â”€â–º logs/service_layer/2026/volunteer_2026.json

3. Cloud Storage ä¸Šä¼ :
   æœ¬åœ° JSON æ–‡ä»¶
        â”‚
        â–¼
   Cloud Storage Manager
        â”‚
        â””â”€â”€â–º gs://grace-irvine-ministry-data/domains/
                  â”œâ”€â”€ sermon/{year}/...
                  â””â”€â”€ volunteer/{year}/...

========================================
        éªŒè¯ç»“æœç»Ÿè®¡
========================================

âœ… éƒ¨ç½²æˆåŠŸæŒ‡æ ‡:
   â€¢ Docker é•œåƒæ„å»º: æˆåŠŸ
   â€¢ Cloud Run éƒ¨ç½²: æˆåŠŸ
   â€¢ å¥åº·æ£€æŸ¥: é€šè¿‡
   â€¢ æ•°æ®æ¸…æ´—: 131 è¡ŒæˆåŠŸå¤„ç†
   â€¢ æœåŠ¡å±‚ç”Ÿæˆ: 8 ä¸ªæ–‡ä»¶æˆåŠŸç”Ÿæˆ
   â€¢ Cloud Storage: 8 ä¸ªæ–‡ä»¶æˆåŠŸä¸Šä¼ 
   â€¢ API ç«¯ç‚¹: æ‰€æœ‰ç«¯ç‚¹æ­£å¸¸å“åº”

ğŸ“Š æ•°æ®ç»Ÿè®¡:
   å¹´ä»½    Sermon  Volunteer
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   2024    52      52
   2025    52      52
   2026    27      27
   Latest  131     131
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   æ€»è®¡:   262     262

âš¡ æ€§èƒ½æŒ‡æ ‡:
   â€¢ æ•°æ®æ¸…æ´—: ~2 ç§’
   â€¢ æœåŠ¡å±‚ç”Ÿæˆ: ~2 ç§’
   â€¢ Cloud Storage ä¸Šä¼ : ~3 ç§’
   â€¢ API å“åº”: < 1 ç§’

========================================
      Quick Commands (å¿«é€Ÿå‘½ä»¤)
========================================

# å¥åº·æ£€æŸ¥
curl https://ministry-data-cleaning-wu7uk5rgdq-uc.a.run.app/health

# æŸ¥çœ‹ API æ–‡æ¡£
open https://ministry-data-cleaning-wu7uk5rgdq-uc.a.run.app/docs

# è¿è¡Œå®Œæ•´æµ‹è¯•
./test_cloud_run_service_layer.sh

# æŸ¥çœ‹ Cloud Storage æ–‡ä»¶
gcloud storage ls gs://grace-irvine-ministry-data/domains/ --recursive

# ä¸‹è½½è¯é“æ•°æ®
gcloud storage cat gs://grace-irvine-ministry-data/domains/sermon/latest.json

# æŸ¥è¯¢ 2024 å¹´è¯é“
curl "https://ministry-data-cleaning-wu7uk5rgdq-uc.a.run.app/api/v1/sermon?year=2024&limit=5"

========================================
           éƒ¨ç½²å®Œæˆï¼ğŸ‰
========================================

æ‰€æœ‰æœåŠ¡å±‚åŠŸèƒ½å·²åœ¨ Cloud Run ä¸ŠæˆåŠŸéƒ¨ç½²å¹¶éªŒè¯é€šè¿‡ï¼

